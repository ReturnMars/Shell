# ShellMars 项目管理文档

## 项目元数据
- **项目名称**: ShellMars
- **项目类型**: 桌面应用程序
- **技术栈**: Tauri + Vue3 + Naive UI + Rust
- **目标平台**: Windows, macOS, Linux
- **开发周期**: 4周28天
- **优先级**: 完成项目优先于Rust学习
- **当前状态**: 基础框架开发阶段
- **设计理念**: 中国阴阳和谐理念 + 黑白灰高级设计
- **最后更新**: 2025-10-18

## 项目目标
**主要目标**: 开发类似XShell的SSH终端工具，具备完整的SSH连接、终端模拟和文件管理功能
**次要目标**: 通过项目驱动开发学习Rust
**设计目标**: 融入中国阴阳和谐理念，打造具有文化内涵的现代化终端工具

## 设计理念

### Naive UI 现代化设计理念
基于Naive UI组件库，打造简洁、现代、功能丰富的终端工具界面：

**核心原则**:
- **组件化设计**: 使用Naive UI丰富的组件库，保持设计一致性
- **简洁高效**: 界面简洁明了，操作高效便捷
- **响应式布局**: 支持不同屏幕尺寸，提供良好的用户体验
- **主题统一**: 使用Naive UI的主题系统，保持视觉统一

**Naive UI设计特点**:
- **组件丰富**: 提供完整的UI组件库，满足各种界面需求
- **主题系统**: 支持亮色/暗色主题切换，提供个性化体验
- **TypeScript**: 完整的TypeScript支持，提供类型安全
- **性能优化**: 组件按需加载，保证应用性能
- **无障碍支持**: 内置无障碍功能，提升可访问性

**设计系统**:
- **色彩**: 使用Naive UI的语义化颜色系统
- **字体**: 集成Lato和FiraCode字体，提供良好的阅读体验
- **图标**: 使用Ant Design图标库，保持图标风格统一
- **布局**: 采用Flexbox布局，支持响应式设计

## 功能需求

### MVP功能 (必须实现)
- ssh连接建立和管理
- 终端模拟器显示和交互
- 基础文件传输_sftp
- 多会话标签页管理
- 连接配置保存加载

### 重要功能 (应该实现)
- 连接历史记录
- 基础设置界面
- 错误处理和重连机制
- 主题切换支持

### 可选功能 (可以延后)
- 高级终端功能
- 复杂文件管理
- 插件系统
- 脚本支持

## 系统架构

### 技术架构
```
前端层: Vue3
  - UI组件: DaisyUI
  - 状态管理: Pinia
  - 终端模拟: xterm.js
  - 通信: IPC

后端层: Rust
  - 命令处理: Tauri
  - SSH管理: ssh2
  - 文件传输服务
  - 配置管理
```

### 模块依赖关系
```
核心UI框架
  -> 连接管理 -> SSH服务
  -> 终端模拟器 -> 终端服务
  -> 文件管理器 -> 文件服务
  -> 设置配置
```

## 模块结构

### 前端模块
```
src/
  components/
    core/
      - MainLayout.vue
      - Sidebar.vue
      - TabBar.vue
    connection/
      - ConnectionList.vue
      - ConnectionForm.vue
      - ConnectionItem.vue
    terminal/
      - TerminalEmulator.vue
      - TerminalTab.vue
      - TerminalSettings.vue
    filemanager/
      - FileTree.vue
      - FileList.vue
      - TransferProgress.vue
    settings/
      - GeneralSettings.vue
      - ThemeSettings.vue
      - AboutPanel.vue
  composables/
    - useConnections.js
    - useTerminal.js
    - useFileManager.js
  stores/
    - connectionStore.js
    - terminalStore.js
    - settingsStore.js
  utils/
    - api.js
    - constants.js
    - helpers.js
```

### 后端模块
```
src-tauri/src/
  main.rs
  commands/
    - connection.rs
    - terminal.rs
    - file_manager.rs
    - settings.rs
  services/
    - ssh_service.rs
    - terminal_service.rs
    - file_service.rs
  models/
    - connection.rs
    - session.rs
    - settings.rs
  utils/
    - crypto.rs
    - storage.rs
    - error.rs
  config/
    - app_config.rs
    - ssh_config.rs
```

## 开发计划

### 阶段一：基础框架 (第1周)
**目标**: 建立开发环境和核心UI框架

#### 任务列表
```
T001: 环境搭建
  优先级: P0
  预估工时: 8小时
  依赖关系: []
  状态: 已完成 ✅
  描述: 安装Rust，创建Tauri项目，配置Vue + DaisyUI
  完成时间: 2025-10-18
  完成内容: 
    - Node.js v25.0.0, Rust 1.90.0, Cargo 1.90.0
    - ShellMars项目创建成功
    - TailwindCSS 4 + DaisyUI 5配置完成
    - Visual Studio Build Tools 2022安装
    - 应用成功启动运行

T002: 基础UI框架
  优先级: P0
  预估工时: 16小时
  依赖关系: [T001]
  状态: 已完成 ✅
  描述: 实现主窗口布局，侧边栏导航，Naive UI主题
  开始时间: 2025-10-18
  完成时间: 2025-10-18
  子任务:
    - T002.1: 主窗口布局设计 (4小时) ✅
    - T002.2: 侧边栏导航组件 (4小时) ✅
    - T002.3: 标签页管理区域 (4小时) ✅
    - T002.4: 响应式设计适配 (4小时) ✅

T003: SSH连接基础
  优先级: P0
  预估工时: 16小时
  依赖关系: [T001, T002]
  状态: 已完成 ✅
  描述: 集成ssh2库，实现基础SSH连接
  完成时间: 2025-10-18
  子任务:
    - T003.1: 添加SSH相关依赖 (1小时) ✅
    - T003.2: 创建连接配置数据结构 (2小时) ✅
    - T003.3: 实现SSH连接服务 (4小时) ✅
    - T003.4: 创建Tauri命令 (3小时) ✅
    - T003.5: 实现连接配置持久化 (2小时) ✅
    - T003.6: 创建连接管理前端组件 (3小时) ✅
    - T003.7: 集成测试SSH连接功能 (1小时) ✅

#### T003子任务详细说明
```
T003.1: 添加SSH相关依赖 ✅
  状态: 已完成
  内容: 添加ssh2, tokio, anyhow, uuid等Rust依赖
  技术要求: 确保依赖版本兼容，支持跨平台
  完成时间: 2025-10-18

T003.2: 创建连接配置数据结构 ✅
  状态: 已完成
  内容: 定义ConnectionConfig, AuthMethod, Session等数据结构
  技术要求: 使用serde序列化，支持JSON格式
  完成时间: 2025-10-18

T003.3: 实现SSH连接服务 ✅
  状态: 已完成
  内容: 基于ssh2库实现SSH连接建立、断开、状态管理
  技术要求: 支持密码和密钥认证，异步处理
  完成时间: 2025-10-18
  完成内容: 
    - 完整的SshService结构体实现
    - 支持密码、密钥、混合认证
    - 异步连接管理和状态跟踪
    - 命令执行和SFTP支持
    - 标签页管理功能

T003.4: 创建Tauri命令 ✅
  状态: 已完成
  内容: 实现connect_ssh, disconnect_ssh, get_connections等命令
  技术要求: 前后端通信，错误处理
  完成时间: 2025-10-18
  完成内容:
    - 15个SSH连接相关命令
    - 完整的错误处理和日志记录
    - 前后端通信接口

T003.5: 实现连接配置持久化 ✅
  状态: 已完成
  内容: 连接配置的保存和加载，本地存储管理
  技术要求: 使用Tauri的存储API，支持加密存储
  完成时间: 2025-10-18
  完成内容:
    - ConnectionStorage完整实现
    - AES-GCM密码加密存储
    - 连接配置CRUD操作
    - 导入导出功能
    - 标签页持久化

T003.6: 创建连接管理前端组件 ✅
  状态: 已完成
  内容: 连接配置表单、连接列表、快速连接等组件
  技术要求: 使用Naive UI组件，响应式设计
  完成时间: 2025-10-18
  完成内容:
    - ConnectionForm.vue完整实现
    - ConnectionList.vue连接管理
    - 集成测试连接和命令功能
    - 完整的UI交互和状态管理

T003.7: 集成测试SSH连接功能 ✅
  状态: 已完成
  内容: 端到端功能测试，错误处理验证
  技术要求: 测试各种连接场景，确保稳定性
  完成时间: 2025-10-18
  完成内容:
    - 连接测试功能集成
    - 命令执行测试
    - 错误处理和用户反馈
    - 状态实时更新
```

T004: 终端显示
  优先级: P0
  预估工时: 16小时
  依赖关系: [T002, T003]
  状态: 待开始
  描述: 集成xterm.js，实现终端显示组件
  子任务:
    - T004.1: 安装终端相关依赖 (2小时) ⏳
    - T004.2: 创建终端数据结构和模型 (2小时) ⏳
    - T004.3: 实现Rust终端服务 (4小时) ⏳
    - T004.4: 创建Tauri终端命令 (2小时) ⏳
    - T004.5: 实现前端终端组件 (4小时) ⏳
    - T004.6: 集成终端状态管理 (2小时) ⏳
    - T004.7: 实现终端与SSH连接集成 (2小时) ⏳
    - T004.8: 测试终端功能 (2小时) ⏳

#### T004子任务详细说明
```
T004.1: 安装终端相关依赖 ⏳
  状态: 待开始
  内容: 添加前端和后端终端相关依赖
  技术要求: 
    - 前端: xterm, @xterm/addon-fit, @xterm/addon-web-links, @xterm/addon-search, @xterm/addon-unicode11
    - 后端: futures, tokio-tungstenite
  验收标准: 所有依赖安装成功，项目能正常编译和运行

T004.2: 创建终端数据结构和模型 ✅
  状态: 已完成
  内容: 定义终端相关的数据结构和类型
  技术要求: 
    - Rust: TerminalSession, TerminalStatus, TerminalConfig结构体
    - TypeScript: 对应的前端类型定义
    - 支持序列化/反序列化
  完成时间: 2025-10-18
  完成内容:
    - 完整的Rust终端模型定义
    - 完整的TypeScript类型定义
    - 终端主题配置系统
    - 终端配置管理
    - 支持序列化/反序列化
  验收标准: 数据结构定义完整，类型定义清晰

T004.3: 实现Rust终端服务 ✅
  状态: 已完成
  内容: 基于SSH连接实现终端服务管理
  技术要求: 
    - 创建和管理终端会话
    - 支持数据双向传输
    - 支持终端大小调整
    - 完善的错误处理
  完成时间: 2025-10-18
  完成内容:
    - TerminalService完整实现
    - 基于SSH连接的终端会话管理
    - 支持数据发送和接收
    - 支持终端大小调整
    - 完整的错误处理和日志记录
    - 终端会话统计功能
  验收标准: 能创建和管理终端会话，支持数据双向传输

T004.4: 创建Tauri终端命令 ✅
  状态: 已完成
  内容: 实现终端相关的Tauri命令
  技术要求: 
    - create_terminal_session: 创建终端会话
    - send_terminal_data: 发送数据到终端
    - read_terminal_output: 读取终端输出
    - resize_terminal: 调整终端大小
    - close_terminal_session: 关闭终端会话
  完成时间: 2025-10-18
  完成内容:
    - 25个终端相关Tauri命令
    - 完整的错误处理和日志记录
    - 支持批量操作
    - 统计信息功能
    - 与前端通信接口
  验收标准: 所有命令实现完整，与前端通信正常

T004.5: 实现前端终端组件 ✅
  状态: 已完成
  内容: 创建基于xterm.js的终端组件
  技术要求: 
    - TerminalEmulator.vue: 主终端组件
    - TerminalTab.vue: 终端标签页
    - TerminalToolbar.vue: 终端工具栏
    - useTerminal.js: 终端逻辑组合式函数
  完成时间: 2025-10-18
  完成内容:
    - 完整的终端组件系统
    - 基于xterm.js的终端模拟器
    - 工具栏和状态栏组件
    - 多标签页支持
    - 终端设置面板
    - 组合式函数API
    - 完整的类型定义
  验收标准: 终端显示正常，支持用户输入和调整

T004.6: 集成终端状态管理 ✅
  状态: 已完成
  内容: 将终端功能集成到Pinia状态管理
  技术要求: 
    - 终端会话状态管理
    - 活动会话管理
    - 与组件集成
    - 数据同步
  完成时间: 2025-10-18
  完成内容:
    - 完整的Pinia终端状态管理
    - 终端标签页状态管理
    - 与连接状态同步
    - 终端配置和主题管理
    - 状态中间件和插件
    - 自动初始化和清理
  验收标准: 状态管理完整，与组件集成正常

T004.7: 实现终端与SSH连接集成 ✅
  状态: 已完成
  内容: 将终端功能与现有SSH连接系统集成
  技术要求: 
    - 连接建立时自动创建终端
    - 连接断开时清理终端
    - 标签页与终端关联
    - 状态同步
  完成时间: 2025-10-18
  完成内容:
    - TerminalView终端视图组件
    - 主布局集成终端组件
    - 终端插件注册
    - 连接状态与终端状态同步
    - 自动终端标签页管理
    - 完整的终端展示功能
  验收标准: SSH连接与终端联动，标签页管理正常

T004.8: 测试终端功能 ⏳
  状态: 待开始
  内容: 端到端功能测试，确保终端正常工作
  技术要求: 
    - 基础功能测试：终端创建、输入输出、大小调整
    - 集成测试：SSH连接联动、多标签页切换
    - 性能测试：大量输出处理、内存使用、响应速度
  验收标准: 所有功能测试通过，性能满足要求
```

#### 验收标准
- 项目能正常启动和运行
- 基础UI界面显示正常
- 能建立SSH连接
- 终端界面能显示命令输出
- 支持用户输入和命令执行
- 支持终端大小调整
- 支持多标签页管理
- 与现有SSH连接系统完美集成

### 阶段二：核心功能 (第2周)
**目标**: 实现核心业务功能

#### 任务列表
```
T005: 多会话支持
  优先级: P0
  预估工时: 16小时
  依赖关系: [T004]
  状态: 待开始
  描述: 实现标签页管理，会话切换，状态保持

T006: 文件传输
  优先级: P0
  预估工时: 16小时
  依赖关系: [T003]
  状态: 待开始
  描述: 集成SFTP功能，实现文件上传下载

T007: 连接管理
  优先级: P0
  预估工时: 16小时
  依赖关系: [T003]
  状态: 待开始
  描述: 实现连接保存加载，历史记录，快速连接

T008: 功能集成测试
  优先级: P0
  预估工时: 8小时
  依赖关系: [T005, T006, T007]
  状态: 待开始
  描述: 端到端功能测试，修复问题，性能优化
```

#### 验收标准
- 支持多个SSH会话标签页
- 能进行文件上传下载
- 能保存和加载连接配置
- 所有核心功能集成正常

### 阶段三：用户体验 (第3周)
**目标**: 完善用户界面和体验

#### 任务列表
```
T009: 设置界面
  优先级: P1
  预估工时: 16小时
  依赖关系: [T008]
  状态: 待开始
  描述: 实现设置面板，主题切换，配置持久化

T010: 错误处理
  优先级: P1
  预估工时: 16小时
  依赖关系: [T008]
  状态: 待开始
  描述: 完善错误提示，实现重连机制，日志记录

T011: 界面优化
  优先级: P1
  预估工时: 16小时
  依赖关系: [T009]
  状态: 待开始
  描述: 完善UI细节，添加动画效果，优化响应式设计

T012: 功能测试
  优先级: P1
  预估工时: 8小时
  依赖关系: [T011]
  状态: 待开始
  描述: 全面功能测试，性能测试，兼容性测试
```

#### 验收标准
- 设置界面功能完整
- 错误提示用户友好
- 界面美观易用
- 功能测试通过

### 阶段四：完善发布 (第4周)
**目标**: 代码优化和项目交付

#### 任务列表
```
T013: 代码优化
  优先级: P1
  预估工时: 16小时
  依赖关系: [T012]
  状态: 待开始
  描述: 代码重构，性能优化，内存优化

T014: 打包发布
  优先级: P0
  预估工时: 16小时
  依赖关系: [T013]
  状态: 待开始
  描述: 配置打包参数，生成exe文件，测试安装包

T015: 文档完善
  优先级: P1
  预估工时: 16小时
  依赖关系: [T014]
  状态: 待开始
  描述: 编写用户手册，更新开发文档，准备演示材料

T016: 项目交付
  优先级: P0
  预估工时: 8小时
  依赖关系: [T015]
  状态: 待开始
  描述: 最终测试，项目交付，经验总结，后续规划
```

#### 验收标准
- 代码质量达标
- 成功打包成exe文件
- 文档完整
- 项目交付完成

## 风险管理

### 技术风险
```
Rust学习曲线:
  影响程度: 高
  发生概率: 中
  缓解措施: 简化学习路径，优先使用现成库
  负责人: AI助手

SSH连接稳定性:
  影响程度: 中
  发生概率: 中
  缓解措施: 使用成熟的ssh2库，添加重连机制
  负责人: AI助手

终端模拟器集成:
  影响程度: 中
  发生概率: 低
  缓解措施: 使用成熟的xterm.js库
  负责人: AI助手

跨平台兼容性:
  影响程度: 低
  发生概率: 低
  缓解措施: 使用Tauri框架，充分测试
  负责人: AI助手
```

### 进度风险
```
功能复杂度超预期:
  影响程度: 高
  发生概率: 中
  缓解措施: 简化功能范围，优先MVP
  负责人: AI助手

技术难点阻塞:
  影响程度: 中
  发生概率: 中
  缓解措施: 提前识别，准备备选方案
  负责人: AI助手

测试时间不足:
  影响程度: 中
  发生概率: 低
  缓解措施: 持续测试，并行开发
  负责人: AI助手
```

## 质量保证

### 代码质量标准
- 测试覆盖率: 大于80%
- 代码复杂度: 圈复杂度小于10
- 代码重复率: 小于5%
- 文档覆盖率: 100%公开接口

### 性能标准
- 启动时间: 小于3秒
- 内存占用: 小于100MB
- 响应时间: 小于100毫秒
- 文件大小: 小于50MB

### 测试策略
```
单元测试:
  覆盖范围: 核心业务逻辑
  执行频率: 每次提交
  负责人: AI助手

集成测试:
  覆盖范围: 模块间接口
  执行频率: 每日
  负责人: AI助手

端到端测试:
  覆盖范围: 完整功能流程
  执行频率: 每周
  负责人: AI助手

性能测试:
  覆盖范围: 关键性能指标
  执行频率: 每周
  负责人: AI助手
```

## 设计实施记录

### Naive UI 重构实施
**实施时间**: 2025-10-18
**实施范围**: 从DaisyUI + TailwindCSS完全迁移到Naive UI

**重构内容**:
1. **依赖更新**:
   - 移除: daisyui, tailwindcss, @tailwindcss/vite
   - 新增: naive-ui, vfonts, @vicons/antd
   - 更新: vite.config.ts移除TailwindCSS配置

2. **组件重构**:
   - MainLayout: 使用n-layout系列组件重构
   - Sidebar: 使用n-card, n-button, n-tag等组件
   - TabBar: 使用n-dropdown, n-button等组件
   - App: 使用n-form, n-alert等组件

3. **样式系统**:
   - 移除所有TailwindCSS类名
   - 使用Naive UI组件内置样式
   - 保留必要的自定义CSS用于布局
   - 集成Lato和FiraCode字体

4. **图标系统**:
   - 使用@vicons/antd图标库
   - 统一图标风格和大小
   - 支持主题色彩变化

**技术优势**:
- 组件化程度更高，维护性更好
- TypeScript支持更完善
- 主题系统更灵活
- 性能优化更到位
- 无障碍支持更全面

## 开发规范

### 代码规范
- Rust: 遵循rustfmt和clippy规范
- Vue: 使用Vue3 Composition API
- CSS: 使用TailwindCSS原子化类名 + 阴阳主题定制
- Git: 使用约定式提交规范

### 设计规范
- 色彩: 严格遵循阴阳和谐色彩体系
- 布局: 体现对立统一的平衡美感
- 交互: 保持简洁高级的用户体验
- 组件: 统一的设计语言和视觉风格

### 文档规范
- API文档: 所有公开接口必须有文档
- 代码注释: 关键逻辑必须有注释
- README: 项目根目录必须有README
- 变更日志: 记录所有重要变更

## 进度跟踪

### 关键指标
- 功能完成度: 按模块统计完成百分比
- 代码质量: 测试覆盖率和质量工具
- 性能指标: 启动时间，内存占用，响应速度
- 用户体验: 功能测试和用户反馈

### 里程碑检查点
- 第1周末: 基础功能可用 25%
- 第2周末: 核心功能完整 60%
- 第3周末: 用户体验完善 85%
- 第4周末: 项目完成交付 100%

## 成功标准

### 功能标准
- 能建立SSH连接
- 能显示终端界面
- 能执行命令
- 能传输文件
- 能管理多个会话

### 性能标准
- 启动时间小于3秒
- 内存占用小于100MB
- 响应时间小于100毫秒
- 文件大小小于50MB

### 质量标准
- 无明显bug
- 界面友好
- 操作流畅
- 文档完整

## 学习计划

### Rust学习路径
```
第1周: 基础语法和概念_最低要求
第2周: 项目驱动学习_边做边学
第3周: 按需深入学习_遇到问题再查
第4周: 代码优化和最佳实践
```

### 学习资源
- 官方文档: Rust官方教程
- 实践项目: 边做边学
- 社区支持: Stack Overflow, Reddit
- 代码示例: GitHub开源项目

## 项目状态
- **开始日期**: 2025-10-18
- **预计完成**: 4周
- **项目负责人**: AI助手
- **当前阶段**: 基础框架开发完成，进入核心功能开发
- **当前任务**: T004 终端显示
- **当前子任务**: T004.1 安装终端相关依赖
- **下一步行动**: 开始T004终端显示功能开发
- **完成进度**: 50% (T001完成，T002完成，T003完成)